<div class="box book-entry {{ entry_class }}" {% if book_id %}data-book-id="{{ book_id }}"{% endif %}>
  <button type="button" class="delete delete-btn" aria-label="Eliminar" title="Borrar libro" tabindex="-1"></button>

  {# Hidden fields for formset #}
  {{ form.id }}
  {% if form.temp_cover_id %}
    {{ form.temp_cover_id }}
  {% endif %}

  <div class="columns">
    <div class="column {% if not form.notes %}is-full{% endif %}">
      <div class="field">
        <input class="input" type="text" name="{{ form.title.html_name }}" id="{{ form.title.id_for_label }}" value="{{ form.title.value|default:'' }}" placeholder="TÃ­tulo del libro">
        {% if form.title.errors %}
          <p class="help is-danger">{{ form.title.errors.0 }}</p>
        {% endif %}
      </div>
      <div class="field">
        <input class="input" type="text" name="{{ form.author.html_name }}" id="{{ form.author.id_for_label }}" value="{{ form.author.value|default:'' }}" placeholder="Autor">
        {% if form.author.errors %}
          <p class="help is-danger">{{ form.author.errors.0 }}</p>
        {% endif %}
      </div>
      {% if form.temp_cover_id %}
      <div class="field">
        <input type="file" name="temp_cover_image" accept="image/*" capture="environment" style="display: none;" class="temp-photo-input" data-form-prefix="{{ form.prefix }}">
        <button type="button" class="button is-info is-small is-light temp-upload-trigger" data-form-prefix="{{ form.prefix }}">
          <span class="icon is-small">
            <i class="fas fa-camera"></i>
          </span>
          <span class="temp-upload-text">Agregar foto</span>
        </button>
        <div class="temp-photo-preview" data-form-prefix="{{ form.prefix }}" style="display: none; margin-top: 0.5rem;">
          <img src="" alt="Preview" style="max-width: 60px; max-height: 90px; border-radius: 4px;">
        </div>
      </div>
      {% endif %}
    </div>
    {% if form.notes %}
    <div class="column">
      {{ form.notes }}
      {% if form.notes.errors %}
        <p class="help is-danger">{{ form.notes.errors.0 }}</p>
      {% endif %}
    </div>
    {% endif %}
  </div>

  {# Hidden DELETE checkbox (we'll handle this with JavaScript) #}
  <div style="display: none;">
    {{ form.DELETE }}
  </div>
</div>
